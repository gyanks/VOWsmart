
const mongoose = require('mongoose');
const Schema = mongoose.Schema;
/* defining schema for  CVE Review by User */


/* Model for CVE

vulnId: cveData.cve.CVE_data_meta.ID,
                description: cveData.cve.description.description_data[0].value,
                //references:cveData.references,
                //componentName: cveData.cve.
                //version:
                //impact":{

                cpe: cveData.configurations?.nodes[0]?.cpe_match[0]?.cpe32URI,
                impactScore: cveData.impact?.baseMetricV3?.impactScore,
                vectorString: cveData.impact?.baseMetricV3?.cvssV3?.vectorString,
                cvvsScore: cveData.impact?.baseMetricV3?.cvssV3?.baseScore,
                severity: cveData.impact?.baseMetricV3?.cvssV3?.baseSeverity


*/

let cveReviewSchema = new Schema({

  _id: String,
  scanId: String,
  user: {
    _id: String,
    name: String
  },
  reviewDate: Date,
  details: [
    {
      vulnId: String,
      impactScore: Number,
      severity: String,
      falsePositive: Boolean,
      comment: String,
      status: String,
    }
  ]
},
  {
    collection: 'CveUserReview'
  });

module.exports = mongoose.model('CveUserReview', cveReviewSchema)
