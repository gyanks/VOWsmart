
const mongoose = require('mongoose');
const Schema = mongoose.Schema;
/* defining schema for  CVE Scan */


/* Model for CVE

vulnId: cveData.cve.CVE_data_meta.ID,
                description: cveData.cve.description.description_data[0].value,
                //references:cveData.references,
                //componentName: cveData.cve.
                //version:
                //impact":{

                cpe: cveData.configurations?.nodes[0]?.cpe_match[0]?.cpe32URI,
                impactScore: cveData.impact?.baseMetricV3?.impactScore,
                vectorString: cveData.impact?.baseMetricV3?.cvssV3?.vectorString,
                cvvsScore: cveData.impact?.baseMetricV3?.cvssV3?.baseScore,
                severity: cveData.impact?.baseMetricV3?.cvssV3?.baseSeverity


*/

let cveSchema= new Schema({

   vulnId : String,
   description : String,
   cpe        :String,
   impactScore:Number,
   vectorString : String,
   cvvsScore:Number,
   severity:String,
   falsePositive:String,
   userComment:String,
   userName:String

});



let componentSchema = new Schema ({

 id: Number,
 componentName:String,
version: String,
vendor: String


});




let projectScanSchema = new Schema({
    _id: String,
    projectName: String,
    scanDate:String,
    scanByUser:String,
    components: [
       { 
         
       scanComponent: componentSchema,
       scanCves :[cveSchema]
      
      }
    ]
    
  }, {
      collection: 'projectScan'
    })
    
  module.exports = mongoose.model('ProjectScan', projectScanSchema);
